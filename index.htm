<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2685.1">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6d6d6d; -webkit-text-stroke: #6d6d6d}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6b0001; -webkit-text-stroke: #6b0001}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #fb0007; -webkit-text-stroke: #fb0007}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #0000ff; -webkit-text-stroke: #0000ff}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; -webkit-text-stroke: #000000}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #4d5055; -webkit-text-stroke: #4d5055}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #18702b; -webkit-text-stroke: #18702b}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; -webkit-text-stroke: #000000; min-height: 16.0px}
    span.s1 {font-kerning: none; background-color: #ecf1f7}
    span.s2 {font-kerning: none; color: #fb0007; background-color: #ecf1f7; -webkit-text-stroke: 0px #fb0007}
    span.s3 {font-kerning: none; color: #2a2a2a; background-color: #ecf1f7; -webkit-text-stroke: 0px #2a2a2a}
    span.s4 {font-kerning: none; color: #000000; background-color: #ecf1f7; -webkit-text-stroke: 0px #000000}
    span.s5 {font-kerning: none; color: #0000ff; background-color: #ecf1f7; -webkit-text-stroke: 0px #0000ff}
    span.s6 {font-kerning: none; color: #6b0001; background-color: #ecf1f7; -webkit-text-stroke: 0px #6b0001}
    span.s7 {font-kerning: none; color: #18702b; background-color: #ecf1f7; -webkit-text-stroke: 0px #18702b}
    span.s8 {font-kerning: none; color: #093c94; background-color: #ecf1f7; -webkit-text-stroke: 0px #093c94}
    span.s9 {font-kerning: none; color: #6f0ec3; background-color: #ecf1f7; -webkit-text-stroke: 0px #6f0ec3}
    span.s10 {font-kerning: none}
    span.s11 {font-kerning: none; color: #a4450b; background-color: #ecf1f7; -webkit-text-stroke: 0px #a4450b}
    span.s12 {font-kerning: none; color: #0e6e6d; background-color: #ecf1f7; -webkit-text-stroke: 0px #0e6e6d}
    span.s13 {font-kerning: none; color: #4d5055; background-color: #ecf1f7; -webkit-text-stroke: 0px #4d5055}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE</span><span class="s2"> html</span><span class="s1">&gt;</span></p>
<p class="p2"><span class="s3">&lt;</span><span class="s1">html</span><span class="s4"> </span><span class="s2">lang</span><span class="s3">=</span><span class="s5">"ko"</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s1">charset</span><span class="s3">=</span><span class="s5">"UTF-8"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"viewport"</span><span class="s4"> </span><span class="s2">content</span><span class="s3">=</span><span class="s1">"width=device-width, initial-scale=1.0"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">title</span><span class="s3">&gt;</span><span class="s1">2026년 응급실 스케줄 생성기 (V6)</span><span class="s3">&lt;/</span><span class="s6">title</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Tailwind CSS 로드 --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdn.tailwindcss.com"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* Inter 폰트 적용 */</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">body</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-family:</span><span class="s1"> </span><span class="s7">'Inter'</span><span class="s1">, </span><span class="s8">sans-serif</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s9">@import</span><span class="s4"> </span><span class="s8">url</span><span class="s4">(</span><span class="s1">'https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&amp;display=swap'</span><span class="s4">);</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;/</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s3">&lt;</span><span class="s6">body</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-gray-100 p-4 md:p-8"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"max-w-7xl mx-auto bg-white p-6 md:p-8 rounded-xl shadow-lg"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">h1</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-3xl font-bold text-blue-700 mb-4"</span><span class="s3">&gt;</span><span class="s4">2026년 응급실 스케줄 생성기 (V6)</span><span class="s3">&lt;/</span><span class="s6">h1</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-gray-700 mb-6"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>최종 버전: 4대 근무 유형(평일주간/야간, 휴일주간/야간)의 공정성을 최우선으로 고려합니다.</span><span class="s3">&lt;</span><span class="s6">br</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">strong</span><span class="s3">&gt;</span><span class="s1">규칙:</span><span class="s3">&lt;/</span><span class="s6">strong</span><span class="s3">&gt;</span><span class="s1"> 1. 연속 근무 금지. 2. 5단계 동적 공정성 배분. 3. 파트너 순환.</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- 통계 섹션 --&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"mb-6"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-2xl font-semibold text-gray-800 mb-3"</span><span class="s3">&gt;</span><span class="s4">의사별 근무 통계 (4대 유형)</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"stats"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4"</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">&lt;!-- 통계 데이터가 여기에 동적으로 삽입됩니다. --&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- 스케줄 테이블 섹션 --&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex justify-between items-center mb-3"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-2xl font-semibold text-gray-800"</span><span class="s3">&gt;</span><span class="s4">2026년 스케줄 표 (휴일 </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-red-100 bg-red-500 px-1 rounded"</span><span class="s3">&gt;</span><span class="s4">배경</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4">)</span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">&lt;!-- CSV 내보내기 버튼 --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"export-csv-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-green-600 text-white font-semibold px-4 py-2 rounded-lg shadow-md hover:bg-green-700 transition duration-200"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>CSV로 내보내기</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"overflow-x-auto rounded-lg border border-gray-200"</span><span class="s4"> </span><span class="s2">style</span><span class="s3">=</span><span class="s1">"max-height: 600px;"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">table</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"min-w-full divide-y divide-gray-200"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">thead</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-gray-50 sticky top-0"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">tr</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">th</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"</span><span class="s3">&gt;</span><span class="s4">날짜</span><span class="s3">&lt;/</span><span class="s6">th</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">th</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"</span><span class="s3">&gt;</span><span class="s4">요일</span><span class="s3">&lt;/</span><span class="s6">th</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">th</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"</span><span class="s3">&gt;</span><span class="s4">주간 (Day)</span><span class="s3">&lt;/</span><span class="s6">th</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">th</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"</span><span class="s3">&gt;</span><span class="s4">야간 (Night)</span><span class="s3">&lt;/</span><span class="s6">th</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;/</span><span class="s6">tr</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">thead</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">tbody</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"schedule-body"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-white divide-y divide-gray-200"</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s1">&lt;!-- 스케줄 데이터가 여기에 동적으로 삽입됩니다. --&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">tbody</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">table</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">let</span><span class="s1"> generatedSchedule = [];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">const</span><span class="s1"> doctorsList = [</span><span class="s7">'A'</span><span class="s1">, </span><span class="s7">'B'</span><span class="s1">, </span><span class="s7">'C'</span><span class="s1">, </span><span class="s7">'D'</span><span class="s1">, </span><span class="s7">'E'</span><span class="s1">, </span><span class="s7">'F'</span><span class="s1">, </span><span class="s7">'G'</span><span class="s1">, </span><span class="s7">'H'</span><span class="s1">, </span><span class="s7">'I'</span><span class="s1">, </span><span class="s7">'J'</span><span class="s1">, </span><span class="s7">'K'</span><span class="s1">, </span><span class="s7">'L'</span><span class="s1">];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">const</span><span class="s1"> year = </span><span class="s11">2026</span><span class="s1">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// [V5] 2026년 대한민국 공휴일 (주말 제외)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">const</span><span class="s1"> publicHolidays = </span><span class="s9">new</span><span class="s1"> </span><span class="s12">Set</span><span class="s1">([</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">'2026-01-01'</span><span class="s1">, </span><span class="s13">// 신정</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">'2026-02-16'</span><span class="s1">, </span><span class="s13">// 설날 연휴</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">'2026-02-17'</span><span class="s1">, </span><span class="s13">// 설날</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">'2026-02-18'</span><span class="s1">, </span><span class="s13">// 설날 연휴</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">'2026-03-02'</span><span class="s1">, </span><span class="s13">// 삼일절 (대체)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">'2026-05-05'</span><span class="s1">, </span><span class="s13">// 어린이날</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">'2026-05-25'</span><span class="s1">, </span><span class="s13">// 부처님오신날 (대체)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">'2026-06-03'</span><span class="s1">, </span><span class="s13">// 지방선거일</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">'2026-08-17'</span><span class="s1">, </span><span class="s13">// 광복절 (대체)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">'2026-09-24'</span><span class="s1">, </span><span class="s13">// 추석 연휴</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">'2026-09-25'</span><span class="s1">, </span><span class="s13">// 추석</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">'2026-10-05'</span><span class="s1">, </span><span class="s13">// 개천절 (대체)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">'2026-10-09'</span><span class="s1">, </span><span class="s13">// 한글날</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">'2026-12-25'</span><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s13">// 성탄절</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>]);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// [V5] 날짜가 휴일(주말+공휴일)인지 확인하는 함수</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">function</span><span class="s1"> isHoliday(date, holidaySet) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> day = date.getDay();</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 0: 일요일, 6: 토요일</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">if</span><span class="s1"> (day === </span><span class="s11">0</span><span class="s1"> || day === </span><span class="s11">6</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">return</span><span class="s1"> </span><span class="s9">true</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// YYYY-MM-DD 형식의 문자열로 변환</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> dateString = date.toISOString().split(</span><span class="s7">'T'</span><span class="s1">)[</span><span class="s11">0</span><span class="s1">];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">if</span><span class="s1"> (holidaySet.has(dateString)) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">return</span><span class="s1"> </span><span class="s9">true</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">return</span><span class="s1"> </span><span class="s9">false</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// [V6] 동적 정렬 함수</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s13">/**</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>* @param {Array&lt;Object&gt;} availableDocs - 근무 가능한 의사 배열</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>* @param {String} shiftType - 'HOLIDAY_DAY', 'HOLIDAY_NIGHT', 'WEEKDAY_DAY', 'WEEKDAY_NIGHT'</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>* @returns {Array&lt;Object&gt;} 정렬된 의사 배열</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">         </span>*/</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">function</span><span class="s1"> getSortedPool(availableDocs, shiftType) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>availableDocs.sort((a, b) =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">switch</span><span class="s1"> (shiftType) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">case</span><span class="s1"> </span><span class="s7">'HOLIDAY_DAY'</span><span class="s1">:</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">if</span><span class="s1"> (a.holidayDayShifts !== b.holidayDayShifts) </span><span class="s9">return</span><span class="s1"> a.holidayDayShifts - b.holidayDayShifts;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">if</span><span class="s1"> (a.totalHolidayShifts !== b.totalHolidayShifts) </span><span class="s9">return</span><span class="s1"> a.totalHolidayShifts - b.totalHolidayShifts;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">if</span><span class="s1"> (a.dayShifts !== b.dayShifts) </span><span class="s9">return</span><span class="s1"> a.dayShifts - b.dayShifts;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">if</span><span class="s1"> (a.totalShifts !== b.totalShifts) </span><span class="s9">return</span><span class="s1"> a.totalShifts - b.totalShifts;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">return</span><span class="s1"> a.lastShift - b.lastShift;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">case</span><span class="s1"> </span><span class="s7">'HOLIDAY_NIGHT'</span><span class="s1">:</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">if</span><span class="s1"> (a.holidayNightShifts !== b.holidayNightShifts) </span><span class="s9">return</span><span class="s1"> a.holidayNightShifts - b.holidayNightShifts;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">if</span><span class="s1"> (a.totalHolidayShifts !== b.totalHolidayShifts) </span><span class="s9">return</span><span class="s1"> a.totalHolidayShifts - b.totalHolidayShifts;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">if</span><span class="s1"> (a.nightShifts !== b.nightShifts) </span><span class="s9">return</span><span class="s1"> a.nightShifts - b.nightShifts;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">if</span><span class="s1"> (a.totalShifts !== b.totalShifts) </span><span class="s9">return</span><span class="s1"> a.totalShifts - b.totalShifts;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">return</span><span class="s1"> a.lastShift - b.lastShift;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">case</span><span class="s1"> </span><span class="s7">'WEEKDAY_DAY'</span><span class="s1">:</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">if</span><span class="s1"> (a.weekdayDayShifts !== b.weekdayDayShifts) </span><span class="s9">return</span><span class="s1"> a.weekdayDayShifts - b.weekdayDayShifts;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">if</span><span class="s1"> (a.totalWeekdayShifts !== b.totalWeekdayShifts) </span><span class="s9">return</span><span class="s1"> a.totalWeekdayShifts - b.totalWeekdayShifts;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">if</span><span class="s1"> (a.dayShifts !== b.dayShifts) </span><span class="s9">return</span><span class="s1"> a.dayShifts - b.dayShifts;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">if</span><span class="s1"> (a.totalShifts !== b.totalShifts) </span><span class="s9">return</span><span class="s1"> a.totalShifts - b.totalShifts;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">return</span><span class="s1"> a.lastShift - b.lastShift;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">case</span><span class="s1"> </span><span class="s7">'WEEKDAY_NIGHT'</span><span class="s1">:</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">if</span><span class="s1"> (a.weekdayNightShifts !== b.weekdayNightShifts) </span><span class="s9">return</span><span class="s1"> a.weekdayNightShifts - b.weekdayNightShifts;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">if</span><span class="s1"> (a.totalWeekdayShifts !== b.totalWeekdayShifts) </span><span class="s9">return</span><span class="s1"> a.totalWeekdayShifts - b.totalWeekdayShifts;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">if</span><span class="s1"> (a.nightShifts !== b.nightShifts) </span><span class="s9">return</span><span class="s1"> a.nightShifts - b.nightShifts;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">if</span><span class="s1"> (a.totalShifts !== b.totalShifts) </span><span class="s9">return</span><span class="s1"> a.totalShifts - b.totalShifts;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">return</span><span class="s1"> a.lastShift - b.lastShift;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">return</span><span class="s1"> availableDocs;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>document.addEventListener(</span><span class="s7">'DOMContentLoaded'</span><span class="s1">, () =&gt; {</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 1. [V6] 의사 정보 객체 최종 확장</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">let</span><span class="s1"> doctors = doctorsList.map(id =&gt; ({</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>id: id,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>lastShift: </span><span class="s11">0</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>totalShifts: </span><span class="s11">0</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>dayShifts: </span><span class="s11">0</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>nightShifts: </span><span class="s11">0</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>totalHolidayShifts: </span><span class="s11">0</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>totalWeekdayShifts: </span><span class="s11">0</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>holidayDayShifts: </span><span class="s11">0</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>holidayNightShifts: </span><span class="s11">0</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>weekdayDayShifts: </span><span class="s11">0</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>weekdayNightShifts: </span><span class="s11">0</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}));</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">let</span><span class="s1"> whoWorkedNightYesterday = []; </span><span class="s13">// 전날 야간 근무자</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">let</span><span class="s1"> currentShiftTime = </span><span class="s11">1</span><span class="s1">; </span><span class="s13">// 근무 시점을 기록할 가상 시간</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">let</span><span class="s1"> partnerSelectionOffset = </span><span class="s11">1</span><span class="s1">; </span><span class="s13">// 파트너 순환용 오프셋</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> startDate = </span><span class="s9">new</span><span class="s1"> </span><span class="s12">Date</span><span class="s1">(year, </span><span class="s11">0</span><span class="s1">, </span><span class="s11">7</span><span class="s1">); </span><span class="s13">// 1월 6일로 시작일 변경</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> endDate = </span><span class="s9">new</span><span class="s1"> </span><span class="s12">Date</span><span class="s1">(year, </span><span class="s11">11</span><span class="s1">, </span><span class="s11">31</span><span class="s1">);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">for</span><span class="s1"> (</span><span class="s9">let</span><span class="s1"> d = </span><span class="s9">new</span><span class="s1"> </span><span class="s12">Date</span><span class="s1">(startDate); d &lt;= endDate; d.setDate(d.getDate() + </span><span class="s11">1</span><span class="s1">)) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> currentDate = </span><span class="s9">new</span><span class="s1"> </span><span class="s12">Date</span><span class="s1">(d);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> dateString = currentDate.toISOString().split(</span><span class="s7">'T'</span><span class="s1">)[</span><span class="s11">0</span><span class="s1">];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> dayOfWeek = [</span><span class="s7">'일'</span><span class="s1">, </span><span class="s7">'월'</span><span class="s1">, </span><span class="s7">'화'</span><span class="s1">, </span><span class="s7">'수'</span><span class="s1">, </span><span class="s7">'목'</span><span class="s1">, </span><span class="s7">'금'</span><span class="s1">, </span><span class="s7">'토'</span><span class="s1">][currentDate.getDay()];</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> todayIsHoliday = isHoliday(currentDate, publicHolidays);</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s13">// [V6] 근무 유형 정의</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> dayShiftType = todayIsHoliday ? </span><span class="s7">'HOLIDAY_DAY'</span><span class="s1"> : </span><span class="s7">'WEEKDAY_DAY'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> nightShiftType = todayIsHoliday ? </span><span class="s7">'HOLIDAY_NIGHT'</span><span class="s1"> : </span><span class="s7">'WEEKDAY_NIGHT'</span><span class="s1">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// --- 주간 근무 배정 ---</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">let</span><span class="s1"> dayPool = doctors.filter(doc =&gt; !whoWorkedNightYesterday.includes(doc.id));</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s13">// [V6] 동적 정렬 적용</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>dayPool = getSortedPool(dayPool, dayShiftType);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">let</span><span class="s1"> doc1_day = dayPool[</span><span class="s11">0</span><span class="s1">];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">let</span><span class="s1"> doc2_day_index = (partnerSelectionOffset % (dayPool.length - </span><span class="s11">1</span><span class="s1">)) + </span><span class="s11">1</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">let</span><span class="s1"> doc2_day = dayPool[doc2_day_index];</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">let</span><span class="s1"> dayShift = [doc1_day, doc2_day];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>partnerSelectionOffset++;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> dayShiftIds = dayShift.map(d =&gt; d.id).sort();</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// [V6] 주간 근무 통계 상세 업데이트</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>dayShiftIds.forEach(id =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">const</span><span class="s1"> docIndex = doctors.findIndex(d =&gt; d.id === id);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">if</span><span class="s1">(docIndex &gt; -</span><span class="s11">1</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>doctors[docIndex].lastShift = currentShiftTime;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>doctors[docIndex].totalShifts++;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>doctors[docIndex].dayShifts++;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">if</span><span class="s1"> (todayIsHoliday) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>doctors[docIndex].totalHolidayShifts++;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>doctors[docIndex].holidayDayShifts++;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>} </span><span class="s9">else</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>doctors[docIndex].totalWeekdayShifts++;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>doctors[docIndex].weekdayDayShifts++;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// --- 야간 근무 배정 ---</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">let</span><span class="s1"> nightPool = doctors.filter(doc =&gt; !dayShiftIds.includes(doc.id));</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s13">// [V6] 동적 정렬 적용</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>nightPool = getSortedPool(nightPool, nightShiftType);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">let</span><span class="s1"> doc1_night = nightPool[</span><span class="s11">0</span><span class="s1">];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">let</span><span class="s1"> doc2_night_index = (partnerSelectionOffset % (nightPool.length - </span><span class="s11">1</span><span class="s1">)) + </span><span class="s11">1</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">let</span><span class="s1"> doc2_night = nightPool[doc2_night_index];</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">let</span><span class="s1"> nightShift = [doc1_night, doc2_night];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>partnerSelectionOffset++;<span class="Apple-converted-space"> </span></span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> nightShiftIds = nightShift.map(d =&gt; d.id).sort();</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// [V6] 야간 근무 통계 상세 업데이트</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>nightShiftIds.forEach(id =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">const</span><span class="s1"> docIndex = doctors.findIndex(d =&gt; d.id === id);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                     </span></span><span class="s9">if</span><span class="s1">(docIndex &gt; -</span><span class="s11">1</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>doctors[docIndex].lastShift = currentShiftTime;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>doctors[docIndex].totalShifts++;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>doctors[docIndex].nightShifts++;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">if</span><span class="s1"> (todayIsHoliday) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>doctors[docIndex].totalHolidayShifts++;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>doctors[docIndex].holidayNightShifts++;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>} </span><span class="s9">else</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>doctors[docIndex].totalWeekdayShifts++;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>doctors[docIndex].weekdayNightShifts++;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// --- 전역 스케줄 변수에 저장 ---</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>generatedSchedule.push({</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>date: dateString,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>dayOfWeek: dayOfWeek,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>day: dayShiftIds,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>night: nightShiftIds,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>isHoliday: todayIsHoliday</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>whoWorkedNightYesterday = [...nightShiftIds];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>currentShiftTime++;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// --- 결과 렌더링 ---</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>renderTable(generatedSchedule);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>renderStats(doctors);</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 버튼 이벤트 리스너 연결</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'export-csv-btn'</span><span class="s1">).addEventListener(</span><span class="s7">'click'</span><span class="s1">, exportToCSV);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// 테이블 렌더링 함수</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">function</span><span class="s1"> renderTable(schedule) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> scheduleBody = document.getElementById(</span><span class="s7">'schedule-body'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">let</span><span class="s1"> tableHtml = </span><span class="s7">''</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>schedule.forEach(item =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> rowClass = item.isHoliday ? </span><span class="s7">'bg-red-50'</span><span class="s1"> : </span><span class="s7">''</span><span class="s1">;<span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>tableHtml += </span><span class="s7">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;tr class="</span><span class="s4">${rowClass}</span><span class="s1">"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900"&gt;</span><span class="s4">${item.date}</span><span class="s1">&lt;/td&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500"&gt;</span><span class="s4">${item.dayOfWeek}</span><span class="s1">&lt;/td&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;td class="px-4 py-3 whitespace-nowrap text-sm font-semibold text-blue-600"&gt;</span><span class="s4">${item.day.join(</span><span class="s1">', '</span><span class="s4">)}</span><span class="s1">&lt;/td&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;td class="px-4 py-3 whitespace-nowrap text-sm font-semibold text-indigo-600"&gt;</span><span class="s4">${item.night.join(</span><span class="s1">', '</span><span class="s4">)}</span><span class="s1">&lt;/td&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/tr&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>scheduleBody.innerHTML = tableHtml;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// [V6] 통계 렌더링 함수 (4대 유형, 순서 변경됨)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">function</span><span class="s1"> renderStats(doctors) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> statsDiv = document.getElementById(</span><span class="s7">'stats'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">let</span><span class="s1"> statsHtml = </span><span class="s7">''</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>doctors.sort((a, b) =&gt; a.id.localeCompare(b.id)); </span><span class="s13">// ID 순으로 정렬</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>doctors.forEach(doc =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>statsHtml += </span><span class="s7">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="bg-gray-50 p-3 rounded-lg shadow-sm"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="font-bold text-lg text-gray-800"&gt;</span><span class="s4">${doc.id}</span><span class="s1">&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="text-sm text-gray-600 mt-1"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>총: &lt;span class="font-semibold text-black"&gt;</span><span class="s4">${doc.totalShifts}</span><span class="s1">&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>(휴일: &lt;span class="font-semibold text-red-600"&gt;</span><span class="s4">${doc.totalHolidayShifts}</span><span class="s1">&lt;/span&gt;)</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div class="mt-1"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>주간: &lt;span class="font-semibold text-blue-600"&gt;</span><span class="s4">${doc.dayShifts}</span><span class="s1">&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;span class="text-xs"&gt;(평: </span><span class="s4">${doc.weekdayDayShifts}</span><span class="s1">, 휴: </span><span class="s4">${doc.holidayDayShifts}</span><span class="s1">)&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div class="mt-1"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>야간: &lt;span class="font-semibold text-indigo-600"&gt;</span><span class="s4">${doc.nightShifts}</span><span class="s1">&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;span class="text-xs"&gt;(평: </span><span class="s4">${doc.weekdayNightShifts}</span><span class="s1">, 휴: </span><span class="s4">${doc.holidayNightShifts}</span><span class="s1">)&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>statsDiv.innerHTML = statsHtml;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// CSV 내보내기 함수</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s9">function</span><span class="s1"> exportToCSV() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">if</span><span class="s1"> (generatedSchedule.length === </span><span class="s11">0</span><span class="s1">) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>console.log(</span><span class="s7">"No schedule data to export."</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">return</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s9">let</span><span class="s4"> csvContent = </span><span class="s1">"Date,DayOfWeek,DayWorker1,DayWorker2,NightWorker1,NightWorker2,IsHoliday\r\n"</span><span class="s4">;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>generatedSchedule.forEach(item =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">const</span><span class="s1"> row = [</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>item.date,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>item.dayOfWeek,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>item.day[</span><span class="s11">0</span><span class="s1">],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>item.day[</span><span class="s11">1</span><span class="s1">],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>item.night[</span><span class="s11">0</span><span class="s1">],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>item.night[</span><span class="s11">1</span><span class="s1">],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>item.isHoliday ? </span><span class="s7">'H'</span><span class="s1"> : </span><span class="s7">''</span><span class="s1"> </span><span class="s13">// 휴일인 경우 'H' 표시</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>].join(</span><span class="s7">","</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>csvContent += row + </span><span class="s7">"\r\n"</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// BOM 추가 (Excel에서 한글 깨짐 방지)</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> </span><span class="s12">BOM</span><span class="s1"> = </span><span class="s7">"\uFEFF"</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> csvData = </span><span class="s12">BOM</span><span class="s1"> + csvContent;</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 파일 다운로드 로직</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> blob = </span><span class="s9">new</span><span class="s1"> </span><span class="s12">Blob</span><span class="s1">([csvData], { type: </span><span class="s7">'text/csv;charset=utf-8;'</span><span class="s1"> });</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> link = document.createElement(</span><span class="s7">"a"</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s9">const</span><span class="s1"> url = </span><span class="s12">URL</span><span class="s1">.createObjectURL(blob);</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>link.setAttribute(</span><span class="s7">"href"</span><span class="s1">, url);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>link.setAttribute(</span><span class="s1">"download"</span><span class="s4">, </span><span class="s1">"2026_ER_Schedule_V6_Jan6.csv"</span><span class="s4">); </span><span class="s13">// 파일명 변경</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>link.style.visibility = </span><span class="s7">'hidden'</span><span class="s1">;</span></p>
<p class="p8"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.body.appendChild(link);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>link.click();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.body.removeChild(link);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p8"><span class="s10"></span><br></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;/</span><span class="s1">body</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;/</span><span class="s1">html</span><span class="s3">&gt;</span></p>
</body>
</html>
